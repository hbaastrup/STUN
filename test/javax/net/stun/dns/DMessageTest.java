/*
 * Copyrigth (C) 2010 Henrik Baastrup.
 *
 * Licensed under the GNU Lesser General Public License version 3;
 * you may not use this file except in compliance with the License.
 * You should have received a copy of the license together with this
 * file but can obtain a copy of the License at:
 *
 *       http://www.gnu.org/licenses/lgpl-3.0.txt
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

package javax.net.stun.dns;

import junit.framework.Assert;
import org.junit.After;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;
import static org.junit.Assert.*;

/**
 *
 * @author Henrik Baastrup
 */
public class DMessageTest {

    public DMessageTest() {
    }

    @Before
    public void setUp() {
    }

    @After
    public void tearDown() {
    }

    /**
     * Test of resetMessage method, of class Message.
     */
    @Test
    public void testCreate() {
        byte testData[] = {
            (byte)0x00,(byte)0x02,(byte)0x85,(byte)0x80,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x03,(byte)0x00,(byte)0x06,(byte)0x00,(byte)0x06,
            (byte)0x04,(byte)0x70,(byte)0x6F,(byte)0x70,(byte)0x64,(byte)0x02,(byte)0x69,(byte)0x78,(byte)0x06,(byte)0x6E,(byte)0x65,(byte)0x74,(byte)0x63,(byte)0x6F,(byte)0x6D,(byte)0x03,(byte)0x63,(byte)0x6F,(byte)0x6D,(byte)0x00,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,
            (byte)0xC0,(byte)0x0C,(byte)0x00,(byte)0x05,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x00,(byte)0x3C,(byte)0x00,(byte)0x19,(byte)0x04,(byte)0x70,(byte)0x6F,(byte)0x70,(byte)0x64,(byte)0x04,(byte)0x62,(byte)0x65,(byte)0x73,(byte)0x74,(byte)0x02,
            (byte)0x69,(byte)0x78,(byte)0x06,(byte)0x6E,(byte)0x65,(byte)0x74,(byte)0x63,(byte)0x6F,(byte)0x6D,(byte)0x03,(byte)0x63,(byte)0x6F,(byte)0x6D,(byte)0x00,
            (byte)0xC0,(byte)0x30,(byte)0x00,(byte)0x05,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x00,(byte)0x00,(byte)0x00,(byte)0x06,(byte)0x03,(byte)0x69,(byte)0x78,(byte)0x36,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x55,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xC7,(byte)0xB6,(byte)0x78,(byte)0x06,
            (byte)0xC0,(byte)0x3A,(byte)0x00,(byte)0x02,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x06,(byte)0x03,(byte)0x6E,(byte)0x73,(byte)0x31,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x3A,(byte)0x00,(byte)0x02,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x06,(byte)0x03,(byte)0x6E,(byte)0x73,(byte)0x31,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x3A,(byte)0x00,(byte)0x02,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x06,(byte)0x03,(byte)0x6E,(byte)0x73,(byte)0x31,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x3A,(byte)0x00,(byte)0x02,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x06,(byte)0x03,(byte)0x6E,(byte)0x73,(byte)0x31,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x3A,(byte)0x00,(byte)0x02,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x0C,(byte)0x09,(byte)0x64,(byte)0x66,(byte)0x77,(byte)0x2D,(byte)0x69,(byte)0x78,(byte)0x6E,(byte)0x73,(byte)0x31,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x3A,(byte)0x00,(byte)0x02,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x0C,(byte)0x09,(byte)0x64,(byte)0x66,(byte)0x77,(byte)0x2D,(byte)0x69,(byte)0x78,(byte)0x6E,(byte)0x73,(byte)0x32,(byte)0xC0,(byte)0x3A,
            (byte)0xC0,(byte)0x77,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xC7,(byte)0xB6,(byte)0x78,(byte)0xCB,
            (byte)0xC0,(byte)0x89,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xC7,(byte)0xB6,(byte)0x78,(byte)0xCA,
            (byte)0xC0,(byte)0x9B,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xC7,(byte)0xB6,(byte)0x78,(byte)0x01,
            (byte)0xC0,(byte)0xAD,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xC7,(byte)0xB6,(byte)0x78,(byte)0x02,
            (byte)0xC0,(byte)0xBF,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xCE,(byte)0xD6,(byte)0x62,(byte)0x21,
            (byte)0xC0,(byte)0xD7,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x01,(byte)0x00,(byte)0x00,(byte)0x1C,(byte)0x20,(byte)0x00,(byte)0x04,(byte)0xCE,(byte)0xD6,(byte)0x62,(byte)0x22,
            (byte)0xC8,(byte)0x4C,(byte)0x7E
        };

        DMessage resoult = DMessage.create(testData, testData.length);

        DResource questions[] = resoult.getQuestions();
        DResource answers[] = resoult.getAnswers();
        DResource authorities[] = resoult.getAuthorities();
        DResource additionals[] = resoult.getAdditionals();

        Assert.assertTrue(questions.length==1);
        Assert.assertTrue(answers.length==3);
        Assert.assertTrue(authorities.length==6);
        Assert.assertTrue(additionals.length==6);

        Assert.assertTrue("popd.ix.netcom.com".equals(questions[0].getName()));

        Assert.assertTrue("popd.ix.netcom.com".equals(answers[0].getName()));
        Assert.assertTrue("popd.best.ix.netcom.com".equals(answers[0].getRDataAsString()));
        Assert.assertTrue("ix6.ix.netcom.com".equals(answers[2].getName()));
        Assert.assertTrue("199.182.120.6".equals(answers[2].getRDataAsString()));
    }

}